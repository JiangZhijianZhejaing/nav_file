rawdata_x=[170 -305 -777 -1192 -1540 -1788 -1923 -1935 -1822 -1597 -1267 -858 -405 73 540 956 1300 1553 1686 1698 1588 1362 1036 622];
rawdata_y=[-1521 -1501 -1353 -1092 -729 -290 188 677 1151 1561 1892 2120 2225 2209 2059 1799 1440 1000 524 33 -441 -855 -1186 -1416];
rawdata_z=[2446 2448 2453 2465 2487 2513 2544 2574 2604 2632 2657 2673 2685 2686 2679 2665 2644 2618 2588 2559 2527 2498 2475 2458];
% p1=1.04627664065387e-07;
% p2=9.90306183495034e-08;
% p3=9.25875217494173e-08;
% p4=1.39138280338177e-08;
% p5=1.25253338220958e-09;
% p6=-1.24474007368196e-08;
% p7=1.81138449775935e-05;
% p8=-6.88099661586634e-05;
% p9=2.48736171083925e-05;
% p1=1.04541888043862e-07;
% p2=9.936146272851734e-08;
% p3=9.249194244086287e-08;
% p4=1.385217664670834e-08;
% p5=1.234862841395224e-09;
% p6=-1.251301297422931e-08;
% p7=1.815944027315257e-05;
% p8=-6.894810989696866e-05;
% p9=2.507316347524976e-05;
% p1=1.04627663560786e-07;
% p2=9.90306203707547e-08;
% p3=9.25875235369134e-08;
% p4=1.3913828311729e-08;
% p5=1.2525331327673e-09;
% p6=-1.24474003881936e-08;
% p7=1.81138447946094e-05;
% p8=-6.88099662905783e-05;
% p9=2.4873619157928e-05;
p1=theta(1);p2=theta(2);p3=theta(4);p4=theta(4);p5=theta(5);p6=theta(6);p7=theta(7);p8=theta(8);p9=theta(9);
% p1=a1;p2=a2;p3=a3;p4=a4;p5=a5;p6=a6;p7=a7;p8=a8;p9=a9;
L=[p1 (p4/2) (p5/2); 
  (p4/2) p2 (p6/2); 
  (p5/2) (p6/2) p3];
b=-inv(L)*[p7/2;
            p8/2;
            p9/2];
% D1=abs(sqrt(p1/n1));
% % D2=D1/1.025;
% % D3=D1/1.055;
% D2=abs(sqrt(p2/n2));
% D3=abs(sqrt(p3/n3));
% L11=1/D1;
% L22=1/D2;
% L33=1/D3;%灵敏度
% A4=[L11,0,0;0,L22,0;0,0,L33]*orth2;%正向
% A5=inv(A4);%再逆向
% truedata1=K1*[rawdata_x(1,:)-b2(1); rawdata_y(1,:)-b2(2); rawdata_z(1,:)-b2(3)];
% L1=chol(L);
% L1=L1';
truedata1=A5*[rawdata_x(1,:)-b(1); rawdata_y(1,:)-b(2); rawdata_z(1,:)-b(3)];
truedata1_x=truedata1(1,:);
truedata1_y=truedata1(2,:);
truedata1_z=truedata1(3,:);
true_fai1=zeros(1,length(rawdata_x));
for i=1:length(rawdata_x);
    if((truedata1_x(i)==0)&&(truedata1_y(i)<0))
        true_fai1(i)=90;
    elseif((truedata1_x(i)==0)&&(truedata1_y(i)>0))
        true_fai1(i)=270;
    elseif((truedata1_x(i)<0))
        true_fai1(i)=(-atan(truedata1_y(i)/truedata1_x(i))*180/pi)+180;
    elseif((truedata1_x(i)>0)&&(truedata1_y(i)<0))
        true_fai1(i)=(-atan(truedata1_y(i)/truedata1_x(i))*180/pi);
    elseif((truedata1_x(i)>0)&&(truedata1_y(i)>0))
        true_fai1(i)=(-atan(truedata1_y(i)/truedata1_x(i))*180/pi)+360;
    end
end 
true_fai1
