function gn = CalcGn(Pos) 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% function：解算当地重力加速度，适用于微型无人机
%
% Prototype: gn = CalcGn(Pos)
% Inputs: Pos - 经纬度位置
% Output: gn - 当地重力加速度
%         
% By Taoran Zhao
% 2023/03/30
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    g0 = 9.780325333434361;   
    sinL = sin(Pos(1));  
    gLh = g0*(1 + 5.27094e-3*sinL^2 + 2.32718e-5*sinL^4) - 3.086e-6*Pos(3); % grs80重力模型
    gn = [0;0;-gLh];